---
- hosts: pull_mode_hosts
  remote_user: root

  vars:

    # schedule is fed directly to cron
    schedule: "*/15 * * * *"

    # User to run ansible-pull as from cron
    cron_user: root

    # File that ansible will use for logs
    logfile: /var/log/ansible-pull.log

    # Directory to where repository will be cloned
    workdir: /var/lib/ansible/local

    # Repository to check out -- YOU MUST CHANGE THIS
    # repo must contain a local.yml file at top level
    #repo_url: git://github.com/sfromm/ansible-playbooks.git
    repo_url: SUPPLY_YOUR_OWN_GIT_URL_HERE

  tasks:
    - name: Install ansible
      ansible.builtin.yum:

    - name: Create local directory to work from
      ansible.builtin.file:

    - name: Copy ansible inventory file to client
      ansible.builtin.copy:

    - name: Create crontab entry to clone/pull git repository
      ansible.builtin.template:

    - name: Create logrotate entry for ansible-pull.log
      ansible.builtin.template:
